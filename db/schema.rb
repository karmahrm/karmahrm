# encoding: UTF-8
# This file is auto-generated from the current state of the database. Instead
# of editing this file, please use the migrations feature of Active Record to
# incrementally modify your database, and then regenerate this schema definition.
#
# Note that this schema.rb definition is the authoritative source for your
# database schema. If you need to create the application database on another
# system, you should be using db:schema:load, not running all the migrations
# from scratch. The latter is a flawed and unsustainable approach (the more migrations
# you'll amass, the slower it'll run and the greater likelihood for issues).
#
# It's strongly recommended that you check this file into your version control system.

ActiveRecord::Schema.define(version: 20_160_327_044_047) do
  # These are extensions that must be enabled in order to support this database
  enable_extension 'plpgsql'

  create_table 'announcement_attachments', force: :cascade do |t|
    t.integer  'announcement_id'
    t.datetime 'created_at',              null: false
    t.datetime 'updated_at',              null: false
    t.string   'attachment_file_name'
    t.string   'attachment_content_type'
    t.integer  'attachment_file_size'
    t.datetime 'attachment_updated_at'
  end

  add_index 'announcement_attachments', ['announcement_id'], name: 'index_announcement_attachments_on_announcement_id', using: :btree

  create_table 'announcements', force: :cascade do |t|
    t.string   'title'
    t.text     'content'
    t.integer  'attachments_count'
    t.text     'limit_to_users'
    t.datetime 'start_delivering_at'
    t.datetime 'stop_delivering_at'
    t.datetime 'created_at',          null: false
    t.datetime 'updated_at',          null: false
  end

  create_table 'auth_tokens', force: :cascade do |t|
    t.string   'token'
    t.string   'token_type'
    t.integer  'user_id'
    t.datetime 'expires_at'
    t.datetime 'created_at', null: false
    t.datetime 'updated_at', null: false
  end

  add_index 'auth_tokens', ['user_id'], name: 'index_auth_tokens_on_user_id', using: :btree

  create_table 'calendar_events', force: :cascade do |t|
    t.string   'title'
    t.text     'description'
    t.text     'comments'
    t.datetime 'start_at'
    t.datetime 'end_at'
    t.string   'location_name'
    t.text     'location_address'
    t.integer  'user_id'
    t.integer  'calendar_event_id'
    t.integer  'context_id'
    t.string   'context_type'
    t.datetime 'created_at',        null: false
    t.datetime 'updated_at',        null: false
  end

  add_index 'calendar_events', ['calendar_event_id'], name: 'index_calendar_events_on_calendar_event_id', using: :btree
  add_index 'calendar_events', %w(context_type context_id), name: 'index_calendar_events_on_context_type_and_context_id', using: :btree
  add_index 'calendar_events', ['user_id'], name: 'index_calendar_events_on_user_id', using: :btree

  create_table 'comments', force: :cascade do |t|
    t.string   'type'
    t.text     'content'
    t.integer  'origin_id'
    t.string   'origin_type'
    t.integer  'user_id'
    t.datetime 'created_at',  null: false
    t.datetime 'updated_at',  null: false
  end

  add_index 'comments', %w(origin_type origin_id), name: 'index_comments_on_origin_type_and_origin_id', using: :btree
  add_index 'comments', ['user_id'], name: 'index_comments_on_user_id', using: :btree

  create_table 'companies', force: :cascade do |t|
    t.string   'name'
    t.datetime 'created_at', null: false
    t.datetime 'updated_at', null: false
  end

  create_table 'departments', force: :cascade do |t|
    t.string   'name'
    t.integer  'company_id'
    t.datetime 'created_at', null: false
    t.datetime 'updated_at', null: false
  end

  create_table 'employees', force: :cascade do |t|
    t.string   'employee_id'
    t.date     'date_of_birth'
    t.string   'gender'
    t.string   'mobile'
    t.date     'date_of_join'
    t.date     'date_of_leaving'
    t.date     'date_of_confirmation'
    t.boolean  'is_active', default: true
    t.string   'marital_status'
    t.string   'employment_status'
    t.string   'city'
    t.string   'nationality'
    t.integer  'private_email'
    t.string   'zipcode'
    t.integer  'referrer_id'
    t.integer  'manager_id'
    t.string   'country_id'
    t.integer  'user_id'
    t.integer  'department_id'
    t.datetime 'created_at',                          null: false
    t.datetime 'updated_at',                          null: false
  end

  add_index 'employees', ['employee_id'], name: 'index_employees_on_employee_id', unique: true, using: :btree
  add_index 'employees', ['manager_id'], name: 'index_employees_on_manager_id', using: :btree
  add_index 'employees', ['referrer_id'], name: 'index_employees_on_referrer_id', using: :btree
  add_index 'employees', ['user_id'], name: 'index_employees_on_user_id', unique: true, using: :btree

  create_table 'identities', force: :cascade do |t|
    t.integer  'user_id'
    t.string   'provider'
    t.string   'uid'
    t.datetime 'created_at', null: false
    t.datetime 'updated_at', null: false
  end

  add_index 'identities', ['user_id'], name: 'index_identities_on_user_id', using: :btree

  create_table 'job_titles', force: :cascade do |t|
    t.string   'name'
    t.text     'description'
    t.datetime 'created_at',  null: false
    t.datetime 'updated_at',  null: false
  end

  create_table 'mailboxer_conversation_opt_outs', force: :cascade do |t|
    t.integer 'unsubscriber_id'
    t.string  'unsubscriber_type'
    t.integer 'conversation_id'
  end

  add_index 'mailboxer_conversation_opt_outs', ['conversation_id'], name: 'index_mailboxer_conversation_opt_outs_on_conversation_id', using: :btree
  add_index 'mailboxer_conversation_opt_outs', %w(unsubscriber_id unsubscriber_type), name: 'index_mailboxer_conversation_opt_outs_on_unsubscriber_id_type', using: :btree

  create_table 'mailboxer_conversations', force: :cascade do |t|
    t.string   'subject',    default: ''
    t.datetime 'created_at',              null: false
    t.datetime 'updated_at',              null: false
  end

  create_table 'mailboxer_notifications', force: :cascade do |t|
    t.string   'type'
    t.text     'body'
    t.string   'subject', default: ''
    t.integer  'sender_id'
    t.string   'sender_type'
    t.integer  'conversation_id'
    t.boolean  'draft', default: false
    t.string   'notification_code'
    t.integer  'notified_object_id'
    t.string   'notified_object_type'
    t.string   'attachment'
    t.datetime 'updated_at',                           null: false
    t.datetime 'created_at',                           null: false
    t.boolean  'global', default: false
    t.datetime 'expires'
  end

  add_index 'mailboxer_notifications', ['conversation_id'], name: 'index_mailboxer_notifications_on_conversation_id', using: :btree
  add_index 'mailboxer_notifications', %w(notified_object_id notified_object_type), name: 'index_mailboxer_notifications_on_notified_object_id_and_type', using: :btree
  add_index 'mailboxer_notifications', %w(sender_id sender_type), name: 'index_mailboxer_notifications_on_sender_id_and_sender_type', using: :btree
  add_index 'mailboxer_notifications', ['type'], name: 'index_mailboxer_notifications_on_type', using: :btree

  create_table 'mailboxer_receipts', force: :cascade do |t|
    t.integer  'receiver_id'
    t.string   'receiver_type'
    t.integer  'notification_id', null: false
    t.boolean  'is_read',                    default: false
    t.boolean  'trashed',                    default: false
    t.boolean  'deleted',                    default: false
    t.string   'mailbox_type', limit: 25
    t.datetime 'created_at',                                 null: false
    t.datetime 'updated_at',                                 null: false
  end

  add_index 'mailboxer_receipts', ['notification_id'], name: 'index_mailboxer_receipts_on_notification_id', using: :btree
  add_index 'mailboxer_receipts', %w(receiver_id receiver_type), name: 'index_mailboxer_receipts_on_receiver_id_and_receiver_type', using: :btree

  create_table 'marks', force: :cascade do |t|
    t.integer  'marker_id'
    t.string   'marker_type'
    t.integer  'markable_id'
    t.string   'markable_type'
    t.string   'mark', limit: 128
    t.datetime 'created_at'
  end

  add_index 'marks', %w(markable_id markable_type mark), name: 'index_marks_on_markable_id_and_markable_type_and_mark', using: :btree
  add_index 'marks', %w(marker_id marker_type mark), name: 'index_marks_on_marker_id_and_marker_type_and_mark', using: :btree

  create_table 'notifications', force: :cascade do |t|
    t.integer  'user_id'
    t.integer  'origin_id'
    t.string   'origin_type'
    t.text     'content'
    t.string   'type'
    t.boolean  'is_read', default: false
    t.string   'path'
    t.datetime 'created_at',                  null: false
    t.datetime 'updated_at',                  null: false
  end

  add_index 'notifications', %w(origin_type origin_id), name: 'index_notifications_on_origin_type_and_origin_id', using: :btree
  add_index 'notifications', ['user_id'], name: 'index_notifications_on_user_id', using: :btree

  create_table 'oauth_access_grants', force: :cascade do |t|
    t.integer  'resource_owner_id', null: false
    t.integer  'application_id',    null: false
    t.string   'token',             null: false
    t.integer  'expires_in',        null: false
    t.text     'redirect_uri',      null: false
    t.datetime 'created_at',        null: false
    t.datetime 'revoked_at'
    t.string   'scopes'
  end

  add_index 'oauth_access_grants', ['token'], name: 'index_oauth_access_grants_on_token', unique: true, using: :btree

  create_table 'oauth_access_tokens', force: :cascade do |t|
    t.integer  'resource_owner_id'
    t.integer  'application_id'
    t.string   'token', null: false
    t.string   'refresh_token'
    t.integer  'expires_in'
    t.datetime 'revoked_at'
    t.datetime 'created_at', null: false
    t.string   'scopes'
  end

  add_index 'oauth_access_tokens', ['refresh_token'], name: 'index_oauth_access_tokens_on_refresh_token', unique: true, using: :btree
  add_index 'oauth_access_tokens', ['resource_owner_id'], name: 'index_oauth_access_tokens_on_resource_owner_id', using: :btree
  add_index 'oauth_access_tokens', ['token'], name: 'index_oauth_access_tokens_on_token', unique: true, using: :btree

  create_table 'oauth_applications', force: :cascade do |t|
    t.string   'name',                      null: false
    t.string   'uid',                       null: false
    t.string   'secret',                    null: false
    t.text     'redirect_uri',              null: false
    t.string   'scopes', default: '', null: false
    t.datetime 'created_at'
    t.datetime 'updated_at'
  end

  add_index 'oauth_applications', ['uid'], name: 'index_oauth_applications_on_uid', unique: true, using: :btree

  create_table 'roles', force: :cascade do |t|
    t.string   'name'
    t.integer  'resource_id'
    t.string   'resource_type'
    t.datetime 'created_at'
    t.datetime 'updated_at'
  end

  add_index 'roles', %w(name resource_type resource_id), name: 'index_roles_on_name_and_resource_type_and_resource_id', using: :btree
  add_index 'roles', ['name'], name: 'index_roles_on_name', using: :btree

  create_table 'searchjoy_searches', force: :cascade do |t|
    t.string   'search_type'
    t.string   'query'
    t.string   'normalized_query'
    t.integer  'results_count'
    t.datetime 'created_at'
    t.integer  'convertable_id'
    t.string   'convertable_type'
    t.datetime 'converted_at'
  end

  add_index 'searchjoy_searches', %w(convertable_id convertable_type), name: 'index_searchjoy_searches_on_convertable_id_and_convertable_type', using: :btree
  add_index 'searchjoy_searches', ['created_at'], name: 'index_searchjoy_searches_on_created_at', using: :btree
  add_index 'searchjoy_searches', %w(search_type created_at), name: 'index_searchjoy_searches_on_search_type_and_created_at', using: :btree
  add_index 'searchjoy_searches', %w(search_type normalized_query created_at), name: 'index_searchjoy_searches_on_search_type_and_normalized_query_an', using: :btree

  create_table 'skills', force: :cascade do |t|
    t.string   'description'
    t.datetime 'created_at',  null: false
    t.datetime 'updated_at',  null: false
  end

  create_table 'taggings', force: :cascade do |t|
    t.integer  'tag_id'
    t.integer  'taggable_id'
    t.string   'taggable_type'
    t.integer  'tagger_id'
    t.string   'tagger_type'
    t.string   'context', limit: 128
    t.datetime 'created_at'
  end

  add_index 'taggings', %w(tag_id taggable_id taggable_type context tagger_id tagger_type), name: 'taggings_idx', unique: true, using: :btree
  add_index 'taggings', %w(taggable_id taggable_type context), name: 'index_taggings_on_taggable_id_and_taggable_type_and_context', using: :btree

  create_table 'tags', force: :cascade do |t|
    t.string  'name'
    t.integer 'taggings_count', default: 0
  end

  add_index 'tags', ['name'], name: 'index_tags_on_name', unique: true, using: :btree

  create_table 'tasks', force: :cascade do |t|
    t.integer  'employee_id'
    t.text     'content'
    t.date     'start_date'
    t.date     'end_date'
    t.boolean  'is_delete', default: false
    t.integer  'priority'
    t.integer  'owner_id'
    t.datetime 'created_at',                  null: false
    t.datetime 'updated_at',                  null: false
  end

  add_index 'tasks', ['employee_id'], name: 'index_tasks_on_employee_id', using: :btree

  create_table 'team_memberships', force: :cascade do |t|
    t.integer  'employee_id'
    t.integer  'team_id'
    t.datetime 'created_at',  null: false
    t.datetime 'updated_at',  null: false
  end

  add_index 'team_memberships', ['employee_id'], name: 'index_team_memberships_on_employee_id', using: :btree
  add_index 'team_memberships', ['team_id'], name: 'index_team_memberships_on_team_id', using: :btree

  create_table 'teams', force: :cascade do |t|
    t.string   'name'
    t.datetime 'created_at', null: false
    t.datetime 'updated_at', null: false
  end

  create_table 'terminations', force: :cascade do |t|
    t.integer  'employee_id'
    t.datetime 'date'
    t.text     'note'
    t.datetime 'created_at',  null: false
    t.datetime 'updated_at',  null: false
  end

  add_index 'terminations', ['employee_id'], name: 'index_terminations_on_employee_id', using: :btree

  create_table 'users', force: :cascade do |t|
    t.string   'email',                  default: '',   null: false
    t.string   'encrypted_password',     default: '',   null: false
    t.string   'reset_password_token'
    t.datetime 'reset_password_sent_at'
    t.datetime 'remember_created_at'
    t.integer  'sign_in_count', default: 0, null: false
    t.datetime 'current_sign_in_at'
    t.datetime 'last_sign_in_at'
    t.string   'current_sign_in_ip'
    t.string   'last_sign_in_ip'
    t.string   'confirmation_token'
    t.datetime 'confirmed_at'
    t.datetime 'confirmation_sent_at'
    t.string   'unconfirmed_email'
    t.integer  'failed_attempts', default: 0, null: false
    t.string   'unlock_token'
    t.datetime 'locked_at'
    t.string   'username'
    t.string   'first_name'
    t.string   'last_name'
    t.boolean  'is_active', default: true
    t.datetime 'created_at',                            null: false
    t.datetime 'updated_at',                            null: false
    t.string   'avatar_file_name'
    t.string   'avatar_content_type'
    t.integer  'avatar_file_size'
    t.datetime 'avatar_updated_at'
  end

  add_index 'users', ['confirmation_token'], name: 'index_users_on_confirmation_token', unique: true, using: :btree
  add_index 'users', ['email'], name: 'index_users_on_email', unique: true, using: :btree
  add_index 'users', ['reset_password_token'], name: 'index_users_on_reset_password_token', unique: true, using: :btree
  add_index 'users', ['unlock_token'], name: 'index_users_on_unlock_token', unique: true, using: :btree

  create_table 'users_roles', id: false, force: :cascade do |t|
    t.integer 'user_id'
    t.integer 'role_id'
  end

  add_index 'users_roles', %w(user_id role_id), name: 'index_users_roles_on_user_id_and_role_id', using: :btree

  create_table 'web_hooks', force: :cascade do |t|
    t.string   'type'
    t.integer  'resource_id'
    t.string   'resource_type'
    t.integer  'user_id'
    t.string   'url'
    t.boolean  'enable_ssl_verification'
    t.datetime 'created_at',              null: false
    t.datetime 'updated_at',              null: false
  end

  add_index 'web_hooks', %w(resource_type resource_id), name: 'index_web_hooks_on_resource_type_and_resource_id', using: :btree
  add_index 'web_hooks', ['user_id'], name: 'index_web_hooks_on_user_id', using: :btree

  add_foreign_key 'announcement_attachments', 'announcements'
  add_foreign_key 'auth_tokens', 'users'
  add_foreign_key 'calendar_events', 'calendar_events'
  add_foreign_key 'calendar_events', 'users'
  add_foreign_key 'identities', 'users'
  add_foreign_key 'mailboxer_conversation_opt_outs', 'mailboxer_conversations', column: 'conversation_id', name: 'mb_opt_outs_on_conversations_id'
  add_foreign_key 'mailboxer_notifications', 'mailboxer_conversations', column: 'conversation_id', name: 'notifications_on_conversation_id'
  add_foreign_key 'mailboxer_receipts', 'mailboxer_notifications', column: 'notification_id', name: 'receipts_on_notification_id'
  add_foreign_key 'notifications', 'users'
  add_foreign_key 'team_memberships', 'employees'
  add_foreign_key 'team_memberships', 'teams'
  add_foreign_key 'terminations', 'employees'
  add_foreign_key 'web_hooks', 'users'
end
